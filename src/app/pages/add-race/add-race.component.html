<div class="drawer">
  <input id="my-drawer-3" type="checkbox" class="drawer-toggle" />
  <div class="drawer-content flex flex-col">
    <div class="w-full navbar bg-primary">
      <div class="flex-none lg:hidden">
        <label
          for="my-drawer-3"
          class="btn btn-square btn-ghost text-primary-content"
        >
          <fa-icon [icon]="faBars" class="fa-xl"></fa-icon>
        </label>
      </div>
      <div class="flex-1 px-2 mx-2">
        <a
          class="btn btn-ghost text-primary-content normal-case text-xl"
          [routerLink]="'/races'"
          >Mis Carreras</a
        >
      </div>
      <div class="flex-none hidden lg:block">
        <ul class="menu menu-horizontal text-primary-content">
          <!-- Navbar menu content here -->
          <li>
            <a [routerLink]="'/races'"
              ><fa-icon [icon]="faHouse" class="fa-xl"></fa-icon>
            </a>
          </li>
          <li>
            <a (click)="authService.signOut()"
              ><fa-icon [icon]="faRightFromBracket" class="fa-xl"></fa-icon>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="hero min-h-screen bg-ghost">
      <div class="hero-content flex-col lg:flex-row-reverse">
        <div class="card flex-shrink-0 w-full max-w-sm shadow-2xl bg-base-100">
          <form [formGroup]="raceForm">
            <div class="card-body">
              <div class="form-control">
                <label class="label">
                  <span class="label-text">Nombre de la carrera</span>
                </label>
                <input
                  required
                  type="text"
                  placeholder="Patagonia Run"
                  [ngClass]="
                    (!raceForm.controls['name'].valid &&
                      raceForm.controls['name'].touched) ||
                    (invalidControls.includes('name') &&
                      !raceForm.controls['name'].touched)
                      ? 'input input-bordered bg-white border-red-500'
                      : 'input input-bordered bg-white'
                  "
                  formControlName="name"
                />
              </div>
              <div class="form-control">
                <label class="label">
                  <span class="label-text">Distancia</span>
                </label>
                <label class="input-group">
                  <input
                    type="number"
                    placeholder="42"
                    min="1"
                    [ngClass]="
                      (!raceForm.controls['distanceValue'].valid &&
                        raceForm.controls['distanceValue'].touched) ||
                      (invalidControls.includes('distanceValue') &&
                        !raceForm.controls['distanceValue'].touched)
                        ? 'input input-bordered bg-white border-red-500'
                        : 'input input-bordered bg-white'
                    "
                    formControlName="distanceValue"
                  />
                  <select
                    class="select select-bordered"
                    formControlName="distanceUnit"
                  >
                    <option selected>Km</option>
                    <option>Mi</option>
                  </select>
                </label>
              </div>
              <div class="form-control">
                <label class="label">
                  <span class="label-text">Tiempo</span>
                </label>
                <input
                  type="text"
                  placeholder="hh:mm:ss"
                  [ngClass]="
                    (!raceForm.controls['time'].valid &&
                      raceForm.controls['time'].touched) ||
                    (invalidControls.includes('time') &&
                      !raceForm.controls['time'].touched)
                      ? 'input input-bordered bg-white border-red-500'
                      : 'input input-bordered bg-white'
                  "
                  formControlName="time"
                  (keyup)="formatRaceTime($event)"
                  value="{{ formatedTime }}"
                  maxlength="8"
                />
              </div>
              <div class="form-control">
                <label class="label">
                  <span class="label-text">Fecha</span>
                </label>
                <input
                  type="date"
                  name="date"
                  placeholder="dd/mm/aaaa"
                  class="input input-bordered bg-white"
                  formControlName="date"
                  [ngClass]="
                    (!raceForm.controls['date'].valid &&
                      raceForm.controls['date'].touched) ||
                    (invalidControls.includes('date') &&
                      !raceForm.controls['date'].touched)
                      ? 'input input-bordered bg-white border-red-500'
                      : 'input input-bordered bg-white'
                  "
                />
              </div>
              <div class="form-control w-full max-w-xs">
                <label class="label">
                  <span class="label-text text-primary">Superficie</span>
                </label>
                <select
                  class="select select-bordered bg-white"
                  formControlName="surface"
                  [ngClass]="
                    (!raceForm.controls['surface'].valid &&
                      raceForm.controls['surface'].touched) ||
                    (invalidControls.includes('surface') &&
                      !raceForm.controls['surface'].touched)
                      ? 'input input-bordered bg-white border-red-500'
                      : 'input input-bordered bg-white'
                  "
                >
                  <option disabled selected [ngValue]="null">ElegÃ­ una</option>
                  <option
                    *ngFor="let surface of surfacesValues"
                    [ngValue]="surface"
                  >
                    {{ surface }}
                  </option>
                </select>
              </div>
              <div class="form-control">
                <label class="label cursor-pointer">
                  <span class="label-text"
                    >Actividad en otra app?
                    <div
                      class="tooltip tooltip-secondary"
                      data-tip="Aca podes pegar el link de tu activdad de Garmin/Strava"
                    >
                      <fa-icon [icon]="faCircleInfo" class="fa-sm"></fa-icon>
                    </div>
                  </span>
                  <input
                    type="checkbox"
                    class="toggle toggle-secondary"
                    (click)="toggleExternalActivityLink($event)"
                  />
                </label>
                <input
                  *ngIf="externalActivity"
                  type="text"
                  placeholder="https://connect.garmin.com/modern/activity/xxxxxxxxx"
                  [ngClass]="
                    (!raceForm.controls['externalActivityUrl'].valid &&
                      raceForm.controls['externalActivityUrl'].touched) ||
                    (invalidControls.includes('externalActivityUrl') &&
                      !raceForm.controls['externalActivityUrl'].touched)
                      ? 'input input-bordered bg-white border-red-500'
                      : 'input input-bordered bg-white'
                  "
                  formControlName="externalActivityUrl"
                />
              </div>
              <div class="form-control mt-6">
                <button
                  class="btn btn-primary"
                  (click)="addRace()"
                  *ngIf="!isCreatingRace"
                >
                  Crear
                </button>
                <button class="btn btn-primary" *ngIf="isCreatingRace">
                  <span class="loading loading-spinner"></span>
                  Creando
                </button>
              </div>
              <div class="alert alert-error" *ngIf="createRaceError">
                <fa-icon [icon]="faCircleExclamation" class="fa-xl"></fa-icon>
                <span>Error! No pudimos crear la carrera ðŸ˜­</span>
                <div>
                  <button
                    class="btn btn-sm btn-ghost"
                    (click)="hideErrorAlert()"
                  >
                    X
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="drawer-side">
    <label for="my-drawer-3" class="drawer-overlay"></label>
    <ul class="menu p-4 w-80 h-full bg-base-200">
      <li>
        <a [routerLink]="'/races'">
          <fa-icon [icon]="faHouse" class="fa-xl"></fa-icon>Ir al inicio</a
        >
      </li>
      <div class="divider"></div>
      <li>
        <a (click)="authService.signOut()">
          <fa-icon [icon]="faRightFromBracket" class="fa-xl"></fa-icon>
          Cerrar sesion
        </a>
      </li>
    </ul>
  </div>
</div>
